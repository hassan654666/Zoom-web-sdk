<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Zoom Embedded Meeting</title>

    <script src="https://source.zoom.us/3.12.0/lib/vendor/react.min.js"></script>
    <script src="https://source.zoom.us/3.12.0/lib/vendor/react-dom.min.js"></script>
    <script src="https://source.zoom.us/3.12.0/lib/vendor/redux.min.js"></script>
    <script src="https://source.zoom.us/3.12.0/lib/vendor/redux-thunk.min.js"></script>
    <script src="https://source.zoom.us/3.12.0/lib/vendor/lodash.min.js"></script>
    <script src="https://source.zoom.us/3.12.0/zoom-meeting-embedded-3.12.0.min.js"></script>

    <style>
      html, body { height: 100%; margin: 0; background: #000; }
      #meetingSDKElement { height: 100vh; width: 100vw; }
      #error { color: red; text-align: center; font-family: sans-serif; }
    </style>
  </head>

  <body>
    <div id="meetingSDKElement"></div>
    <div id="error"></div>

    <script>
      window.addEventListener("DOMContentLoaded", async () => {
        console.log("ZoomMtgEmbedded:", window.ZoomMtgEmbedded);

        const params = new URLSearchParams(window.location.search);
        const meetingNumber = params.get("meetingNumber");
        const signature = decodeURIComponent(params.get("signature") || "");
        const sdkKey = params.get("sdkKey");
        const userName = decodeURIComponent(params.get("name") || "Guest");
        const password = decodeURIComponent(params.get("password") || "").trim();

        if (!meetingNumber || !signature || !sdkKey) {
          document.getElementById("error").innerText = "❌ Missing parameters.";
          return;
        }

        try {
          const client = window.ZoomMtgEmbedded.createClient();
          const meetingSDKElement = document.getElementById("meetingSDKElement");

          await client.init({
            zoomAppRoot: meetingSDKElement,
            language: "en-US",
          });

          await client.join({
            sdkKey,
            signature,
            meetingNumber,
            password,
            userName,
          });

          console.log("✅ Joined meeting successfully!");
        } catch (err) {
          console.error("❌ Join error:", err);
          document.getElementById("error").innerText =
            "❌ Failed to join meeting. See console.";
        }
      });
    </script>
  </body>
</html>
