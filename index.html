<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Zoom Meeting - Auto Join Fullscreen</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Zoom Meeting Embedded SDK v3.12.0 -->
    <script src="https://source.zoom.us/3.12.0/lib/vendor/react.min.js"></script>
    <script src="https://source.zoom.us/3.12.0/lib/vendor/react-dom.min.js"></script>
    <script src="https://source.zoom.us/3.12.0/lib/vendor/redux.min.js"></script>
    <script src="https://source.zoom.us/3.12.0/lib/vendor/redux-thunk.min.js"></script>
    <script src="https://source.zoom.us/3.12.0/lib/vendor/lodash.min.js"></script>
    <script src="https://source.zoom.us/zoom-meeting-embedded-3.12.0.min.js"></script>

    <style>
      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        background-color: #000;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      #meetingContainer {
        position: relative;
        width: 100%;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      #meetingSDKElement {
        width: 100%;
        height: auto;
        max-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      /* --- Fix popper containers to bottom --- */
      .ReactModal__Content,
      .zm-modal-dialog,
      .zm-modal {
        max-width: 100vw !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        top: auto !important;
        margin: 0 auto !important;
        border-radius: 0 !important;
      }

      /* Ensure chat/participants popper fits bottom */
      .zm-popover-content,
      .zm-dialog,
      .zm-modal-content {
        width: 100vw !important;
        max-width: 100vw !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        top: auto !important;
      }
    </style>
  </head>

  <body>
    <div id="meetingContainer">
      <div id="meetingSDKElement"></div>
    </div>

    <script>
      (async () => {
        const meetingSDKElement = document.getElementById("meetingSDKElement");
        const client = ZoomMtgEmbedded.createClient();

        // Replace with actual credentials
        const params = new URLSearchParams(window.location.search);
        const meetingNumber = params.get("meetingNumber");
        const signature = decodeURIComponent(params.get("signature") || "");
        const sdkKey = params.get("sdkKey");
        const userName = decodeURIComponent(params.get("name") || "Guest");
        const password = decodeURIComponent(params.get("password") || "").trim();

        if (!meetingNumber || !signature || !sdkKey) {
          alert("Missing meeting parameters in URL.");
          return;
        }

        try {
          await client.init({
            zoomAppRoot: meetingSDKElement,
            language: "en-US",
            //patchJsMedia: true,
            customize: {
              video: {
                isResizable: true,
                viewSizes: {
                  default: {
                    width: window.innerWidth * 0.95,
                    height: window.innerHeight * 0.95,
                  },
                  ribbon: {
                    width: window.innerWidth * 0.95,
                    height: window.innerHeight * 0.95,
                  },
                },
              },
              chat: {
                popper: {
                  placement: "bottom",
                  disableDraggable: true,
                  anchorElement: meetingSDKElement,
                },
              },
              participants: {
                popper: {
                  placement: "bottom",
                  disableDraggable: true,
                  anchorElement: meetingSDKElement,
                },
              },
              settings: {
                popper: {
                  placement: "bottom",
                  disableDraggable: true,
                  anchorElement: meetingSDKElement,
                },
              },
            },
          });

          await client.join({
            signature: signature,
            sdkKey: sdkKey,
            meetingNumber: meetingNumber,
            password: password,
            userName: userName,
          });

          console.log("✅ Joined meeting automatically!");
        } catch (error) {
          console.error("❌ Error joining meeting:", error);
        }
      })();
    </script>
  </body>
</html>
